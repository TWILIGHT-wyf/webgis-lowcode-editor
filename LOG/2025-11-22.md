# å¼€å‘æ—¥å¿— - 2025å¹´11æœˆ22æ—¥

## ğŸ“ æœ€æ–°æ›´æ–°: åœ°å›¾ç»„ä»¶ç³»ç»Ÿå®Œæ•´å®ç° (2025-11-22 ä¸‹åˆ)

### âœ¨ é‡å¤§åŠŸèƒ½: åŸºäº Leaflet çš„å®Œæ•´åœ°å›¾ç»„ä»¶ä½“ç³»

#### **æ ¸å¿ƒæˆæœ**

- åˆ›å»º **10 ä¸ªä¸“ä¸šåœ°å›¾ç»„ä»¶**,æ¶µç›–åº•å›¾ã€å›¾å±‚ã€æ•°æ®å¯è§†åŒ–ã€äº¤äº’æ§ä»¶
- å®Œæ•´é›†æˆ **Pinia Store** + **æ•°æ®æºç³»ç»Ÿ** + **å±æ€§é¢æ¿**
- æ‰€æœ‰ç»„ä»¶é€šè¿‡ TypeScript ä¸¥æ ¼ç±»å‹æ£€æŸ¥ âœ…
- æä¾› 9 ä¸ª Mock API ç”¨äºæµ‹è¯•åœ°å›¾æ•°æ®

#### **ç»„ä»¶æ¸…å•** (å…± 10 ä¸ª)

| åºå· | ç»„ä»¶å      | åŠŸèƒ½æè¿° | ä»£ç è¡Œæ•° | å…³é”®ç‰¹æ€§                                   |
| ---- | ----------- | -------- | -------- | ------------------------------------------ |
| 1    | **base**    | åº•å›¾ç»„ä»¶ | 164      | OpenStreetMap ç“¦ç‰‡, ä¸­å¿ƒç‚¹é…ç½®, ç¼©æ”¾æ§åˆ¶   |
| 2    | **tile**    | ç“¦ç‰‡å›¾å±‚ | 179      | è‡ªå®šä¹‰ç“¦ç‰‡URL, é€æ˜åº¦, z-index åˆ†å±‚        |
| 3    | **vector**  | çŸ¢é‡å›¾å±‚ | 234      | ç‚¹/çº¿/é¢å‡ ä½•ä½“, è‡ªå®šä¹‰æ ·å¼, å±æ€§å¼¹çª—       |
| 4    | **geojson** | GeoJSON  | 153      | æ ‡å‡† GeoJSON æ”¯æŒ, è‡ªåŠ¨é€‚åº”è§†å›¾            |
| 5    | **marker**  | æ ‡è®°ç‚¹   | 241      | è‡ªå®šä¹‰å›¾æ ‡, æ‹–æ‹½, æ ‡ç­¾, å¼¹çª—               |
| 6    | **cluster** | èšåˆæ ‡è®° | 180      | MarkerClusterGroup, èœ˜è››æ•ˆæœ, å¤§æ•°æ®é‡ä¼˜åŒ– |
| 7    | **heat**    | çƒ­åŠ›å›¾   | 173      | å¯†åº¦å¯è§†åŒ–, æ¸å˜é…ç½®, å¼ºåº¦æ§åˆ¶             |
| 8    | **legend**  | å›¾ä¾‹     | 140      | é¢œè‰²æ˜ å°„, æ–¹å½¢/åœ†å½¢ç¬¦å·, è‡ªå®šä¹‰æ ·å¼        |
| 9    | **scale**   | æ¯”ä¾‹å°º   | 104      | å…¬åˆ¶/è‹±åˆ¶å•ä½, è‡ªåŠ¨è®¡ç®—, åˆ†æ®µæ˜¾ç¤º          |
| 10   | **layers**  | å›¾å±‚æ§åˆ¶ | 228      | å›¾å±‚å¯è§æ€§åˆ‡æ¢, é€æ˜åº¦æ§åˆ¶, ç±»å‹æ ‡ç­¾       |

#### **æŠ€æœ¯æ¶æ„**

**1. ä¾èµ–å®‰è£…**

```bash
npm install leaflet.markercluster leaflet.heat @types/leaflet.markercluster @types/leaflet.heat
```

**2. ç»„ä»¶æ³¨å†Œ** (`src/customComponents/registry.ts`)

- å¯¼å…¥ 10 ä¸ªåœ°å›¾ç»„ä»¶
- æ³¨å†Œåˆ° componentRegistry
- æ€»ç»„ä»¶æ•°: 54 ä¸ª (44 åŸæœ‰ + 10 æ–°å¢)

**3. Store é…ç½®** (`src/stores/component.ts` +200 è¡Œ)

- **defaultStyleByType**: åœ°å›¾ç»„ä»¶é»˜è®¤æ ·å¼
  - åœ°å›¾ç±»: `borderRadius: 0`, `border: 'none'`
  - æ§ä»¶ç±»: ç™½è‰²èƒŒæ™¯, æ ‡å‡† UI æ ·å¼
- **defaultPropsByType**: é»˜è®¤å±æ€§é…ç½®
  - base: åŒ—äº¬åæ ‡ (39.9, 116.4), zoom 13, OSM ç“¦ç‰‡
  - cluster: 80px èšåˆåŠå¾„, zoom 5 å…¨å±€è§†å›¾
  - heat: radius 25, blur 15, è“-ç»¿-çº¢æ¸å˜
  - legend/layers: ç™½è‰²èƒŒæ™¯, æ ‡å‡†é—´è·
- **defaultDataSourceByType**: æ•°æ®æºå­—æ®µæ˜ å°„
  - æ‰€æœ‰ç»„ä»¶æ”¯æŒä» API åŠ¨æ€è·å–æ•°æ®

**4. Mock API** (`test/mockServer.mjs` +150 è¡Œ)
| API | ç«¯ç‚¹ | åŠŸèƒ½ | æ•°æ®ç¤ºä¾‹ |
|-----|------|------|---------|
| #40 | `/api/map/base` | åº•å›¾é…ç½® | éšæœºåŸå¸‚ä¸­å¿ƒç‚¹ (åŒ—äº¬/ä¸Šæµ·/å¹¿å·/æ·±åœ³) |
| #41 | `/api/map/tile` | ç“¦ç‰‡å›¾å±‚ | å«æ˜Ÿå›¾/åœ°å½¢å›¾ URL |
| #42 | `/api/map/vector` | çŸ¢é‡æ•°æ® | ç‚¹/çº¿/é¢æ ·æœ¬æ•°æ® |
| #43 | `/api/map/geojson` | GeoJSON | å¤©å®‰é—¨ç‚¹ + é“è·¯çº¿ FeatureCollection |
| #44 | `/api/map/markers` | æ ‡è®°ç‚¹ | 10 ä¸ªåŒ—äº¬å‘¨è¾¹éšæœºæ ‡è®° |
| #45 | `/api/map/cluster` | èšåˆæ•°æ® | 100 ä¸ªåˆ†å¸ƒå¼æ ‡è®°ç‚¹ |
| #46 | `/api/map/heat` | çƒ­åŠ›æ•°æ® | 200 ä¸ªå¸¦å¼ºåº¦çš„çƒ­ç‚¹ |
| #47 | `/api/map/legend` | å›¾ä¾‹æ•°æ® | 5 ä¸ªé¢œè‰²åˆ†ç±»é¡¹ |
| #48 | `/api/map/layers` | å›¾å±‚åˆ—è¡¨ | 5 ä¸ªå›¾å±‚æ§åˆ¶é¡¹ |

**5. Properties é…ç½®** (`src/components/siderBar/properties/properties.ts` +200 è¡Œ)

**styleSchema**: æ ·å¼é…ç½®

- åœ°å›¾ç»„ä»¶: borderRadius (0-20), border (text)
- æ§ä»¶ç»„ä»¶: backgroundColor, textColor, fontSize, padding

**dataSourceSchema**: æ•°æ®æºé…ç½®

- enabled: å¯ç”¨å¼€å…³
- url: API åœ°å€ (é»˜è®¤ `http://localhost:3001/api/map/{type}`)
- method: GET/POST
- interval: åˆ·æ–°é—´éš” (ç§’)

**componentSchema**: ç»„ä»¶å±æ€§é…ç½® (å®Œæ•´ç¤ºä¾‹)

```typescript
case 'base':
  return [
    { key: 'centerLat', label: 'ä¸­å¿ƒçº¬åº¦', type: 'number', min: -90, max: 90, step: 0.0001 },
    { key: 'centerLng', label: 'ä¸­å¿ƒç»åº¦', type: 'number', min: -180, max: 180, step: 0.0001 },
    { key: 'zoom', label: 'ç¼©æ”¾çº§åˆ«', type: 'number', min: 1, max: 18, step: 1 },
    { key: 'tileUrl', label: 'ç“¦ç‰‡URL', type: 'text', placeholder: 'https://...' },
    { key: 'zoomControl', label: 'ç¼©æ”¾æ§ä»¶', type: 'switch', default: true },
    // ... æ›´å¤šé…ç½®
  ]
```

**6. TypeScript ç±»å‹ä¿®å¤**

- **ä¿®å¤æ¨¡å¼**: Props-based â†’ **Store-based**
- **æ ¸å¿ƒè½¬æ¢**:

  ```typescript
  // ä¿®å¤å‰ (é”™è¯¯)
  const props = defineProps<{ id: string; centerLat?: number; ... }>()
  const { data } = useDataSource(computed(() => props.dataSourceConfig)) // âŒ ç±»å‹ä¸åŒ¹é…

  // ä¿®å¤å (æ­£ç¡®)
  const props = defineProps<{ id: string }>()
  const { componentStore } = storeToRefs(useComponent())
  const comp = computed(() => componentStore.value.find(c => c.id === props.id))
  const dataSourceConfig = computed(() => comp.value?.dataSource)
  const { data } = useDataSource(dataSourceConfig) // âœ… ç±»å‹åŒ¹é…

  // ä½¿ç”¨å±æ€§
  const centerLat = computed(() =>
    dataSourceData.value
      ? (dataSourceData.value as Record<string, unknown>)[field] as number
      : (comp.value?.props.centerLat as number) ?? 39.9
  )
  ```

- **ç±»å‹æ–­è¨€ç­–ç•¥**:
  - `comp.value?.props.xxx as Type` - ä» store è·å–å±æ€§
  - `(dataSourceData.value as Record<string, unknown>)[field]` - åŠ¨æ€å­—æ®µè®¿é—®
  - `field as string | undefined` - é¿å…éšå¼ any
- **ç‰¹æ®Šå¤„ç†**:
  - heat.vue: Leaflet.heat æ’ä»¶ç±»å‹æ‰©å±•
  ```typescript
  interface LeafletHeat extends L.Layer {
    setLatLngs(latlngs: Array<[number, number, number]>): this
  }
  (L as unknown as { heatLayer: (...) => LeafletHeat }).heatLayer(...)
  ```

#### **å®ç°äº®ç‚¹**

1. **æ¶æ„è®¾è®¡**: å®Œå…¨éµå¾ªç°æœ‰ç»„ä»¶ç³»ç»Ÿè§„èŒƒ
   - å•å‘æ•°æ®æµ: Store â†’ Component â†’ UI
   - æ•°æ®æºé›†æˆ: æ”¯æŒ API åŠ¨æ€è·å–æ•°æ®
   - å±æ€§é¢æ¿: å¯è§†åŒ–é…ç½®æ‰€æœ‰å‚æ•°

2. **ç”¨æˆ·ä½“éªŒ**: é«˜åº¦å¯å®šåˆ¶åŒ–
   - æ¯ä¸ªç»„ä»¶ 8-15 ä¸ªé…ç½®é¡¹
   - å®æ—¶æ•°æ®æ›´æ–° (watch ç›‘å¬)
   - å ä½æç¤º (æœªé…ç½®æ—¶æ˜¾ç¤º)

3. **å¼€å‘è€…å‹å¥½**: å®Œæ•´ç±»å‹å®‰å…¨
   - æ‰€æœ‰ç»„ä»¶é€šè¿‡ TypeScript ä¸¥æ ¼æ£€æŸ¥
   - Interface å®šä¹‰æ¸…æ™° (MarkerData, HeatPoint, LayerItem, etc.)
   - æ—  any ç±»å‹ (é™¤å¿…è¦çš„æ’ä»¶ç±»å‹æ‰©å±•)

4. **æ€§èƒ½ä¼˜åŒ–**:
   - cluster: æ”¯æŒ 100+ æ ‡è®°é«˜æ•ˆæ¸²æŸ“
   - heat: 200+ çƒ­ç‚¹æµç•…æ˜¾ç¤º
   - åœ°å›¾å®ä¾‹å¤ç”¨ (é”€æ¯æ—§å®ä¾‹åé‡å»º)

#### **ä½¿ç”¨ç¤ºä¾‹**

**åœºæ™¯ 1: åˆ›å»ºåº•å›¾**

1. ä»ç»„ä»¶åº“æ‹–æ‹½ `base` ç»„ä»¶åˆ°ç”»å¸ƒ
2. åœ¨ Properties é¢æ¿é…ç½®:
   - ä¸­å¿ƒçº¬åº¦: 39.9
   - ä¸­å¿ƒç»åº¦: 116.4
   - ç¼©æ”¾çº§åˆ«: 13
3. å¯ç”¨æ•°æ®æº: è¿æ¥ API #40 åŠ¨æ€åˆ‡æ¢åŸå¸‚

**åœºæ™¯ 2: æ˜¾ç¤ºæ ‡è®°èšåˆ**

1. æ·»åŠ  `cluster` ç»„ä»¶
2. é…ç½®æ•°æ®æº: `http://localhost:3001/api/map/cluster`
3. è°ƒæ•´èšåˆåŠå¾„: 80px
4. å¯ç”¨èœ˜è››æ•ˆæœ (spiderfyOnMaxZoom)

**åœºæ™¯ 3: çƒ­åŠ›å›¾åˆ†æ**

1. æ·»åŠ  `heat` ç»„ä»¶
2. é…ç½®æ•°æ®æº: API #46
3. è°ƒæ•´å‚æ•°: radius 25, blur 15
4. è‡ªå®šä¹‰æ¸å˜: { 0.0: 'blue', 0.5: 'lime', 1.0: 'red' }

#### **æ–‡ä»¶å˜æ›´ç»Ÿè®¡**

```
æ–°å¢æ–‡ä»¶: 10 ä¸ª (base.vue ~ layers.vue)
ä¿®æ”¹æ–‡ä»¶: 4 ä¸ª
  - registry.ts: +20 è¡Œ
  - component.ts: +200 è¡Œ
  - mockServer.mjs: +150 è¡Œ
  - properties.ts: +200 è¡Œ
æ€»ä»£ç é‡: ~1800 è¡Œ
TypeScript é”™è¯¯: 0 âŒ â†’ 0 âœ…
```

---

## æœ¬æ¬¡æ›´æ–°å†…å®¹ (ç›¸è¾ƒäºä¸Šæ¬¡ commit: e4646bc)

### ğŸ› é—®é¢˜ä¿®å¤

#### 1. ä¿®å¤ Video ç»„ä»¶ç±»å‹é”™è¯¯

- **é—®é¢˜**: `objectFit` å±æ€§ç±»å‹ä¸å…¼å®¹
- **è§£å†³**: ä½¿ç”¨ç±»å‹æ–­è¨€ `as 'fill' | 'contain' | 'cover' | 'none'`
- **æ–‡ä»¶**: `src/customComponents/media/video/video.vue`

#### 2. ä¿®å¤ HTML å’Œ iframe ç»„ä»¶æœªæ¸²æŸ“é—®é¢˜

- **é—®é¢˜**: ç»„ä»¶è¢«å­˜å‚¨åˆ° componentStore ä½†ç”»å¸ƒä¸­ä¸æ˜¾ç¤º
- **åŸå› **:
  - HTML ç»„ä»¶é»˜è®¤å†…å®¹ä¸å¤Ÿæ˜æ˜¾
  - iframe ç»„ä»¶é»˜è®¤ URL ä¸ºç©ºå­—ç¬¦ä¸²
- **è§£å†³**:
  - HTML: æ·»åŠ å¸¦æ¸å˜èƒŒæ™¯å’Œæ ·å¼çš„é»˜è®¤å†…å®¹
  - iframe: è®¾ç½®é»˜è®¤ URL ä¸º OpenStreetMap åœ°å›¾
- **æ–‡ä»¶**: `src/stores/component.ts`

---

### âœ¨ æ–°å¢åŠŸèƒ½

#### 3. åˆ›å»º Scripting ç»„ä»¶ (è„šæœ¬æ‰§è¡Œå™¨)

- **åŠŸèƒ½**: JavaScript ä»£ç æ²™ç®±æ‰§è¡Œç¯å¢ƒ
- **ç‰¹æ€§**:
  - å®‰å…¨æ²™ç®±æ‰§è¡Œ (Function æ„é€ å‡½æ•°)
  - è‡ªå®šä¹‰ console å¯¹è±¡æ•è·æ—¥å¿—
  - æ”¯æŒæ‰‹åŠ¨è§¦å‘/è‡ªåŠ¨æ‰§è¡Œæ¨¡å¼
  - ä»£ç æ˜¾ç¤ºåŒº + è¾“å‡ºåŒº
  - é”™è¯¯æ•è·ä¸æç¤º
  - æš—è‰²ä¸»é¢˜ UI (VS Code é£æ ¼)
- **é…ç½®é¡¹**:
  - script: JavaScript ä»£ç 
  - autoRun: è‡ªåŠ¨æ‰§è¡Œå¼€å…³
  - showCode: æ˜¾ç¤ºä»£ç åŒº
  - showControls: æ˜¾ç¤ºæ‰§è¡ŒæŒ‰é’®
  - showPlaceholder: æ˜¾ç¤ºå ä½æç¤º
- **æ•°æ®æº**: æ”¯æŒä» API è·å–è„šæœ¬ä»£ç  (scriptField)
- **æ–‡ä»¶**: `src/customComponents/advanced/scripting/scripting.vue`

#### 4. åˆ›å»º State ç»„ä»¶ (çŠ¶æ€ç®¡ç†å™¨)

- **åŠŸèƒ½**: JSON çŠ¶æ€æ•°æ®å¯è§†åŒ–å±•ç¤º
- **ç‰¹æ€§**:
  - ä¸‰ç§è§†å›¾æ¨¡å¼:
    - åˆ—è¡¨è§†å›¾: åˆ†ç»„å±•ç¤ºé”®å€¼å¯¹,å¸¦ç±»å‹æ ‡ç­¾
    - JSON è§†å›¾: æ ¼å¼åŒ–çš„ JSON æ–‡æœ¬
    - è¡¨æ ¼è§†å›¾: Element Plus è¡¨æ ¼å±•ç¤º
  - è‡ªåŠ¨è§£æ JSON æ•°æ®
  - ç±»å‹æ£€æµ‹ä¸ç€è‰² (string/number/boolean/object)
  - å®æ—¶æ•°æ®åŒæ­¥
  - æš—è‰²ä¸»é¢˜ UI
- **é…ç½®é¡¹**:
  - state: JSON çŠ¶æ€æ•°æ®
  - viewMode: è§†å›¾æ¨¡å¼ (list/json/table)
  - placeholder: ç©ºæ•°æ®æç¤º
- **æ•°æ®æº**: æ”¯æŒä» API è·å–çŠ¶æ€æ•°æ® (stateField)
- **æ–‡ä»¶**: `src/customComponents/advanced/state/state.vue`

#### 5. åˆ›å»º Trigger ç»„ä»¶ (è§¦å‘å™¨)

- **åŠŸèƒ½**: å®šæ—¶/æ‰‹åŠ¨è§¦å‘å™¨,æ‰§è¡Œé¢„è®¾åŠ¨ä½œ
- **ç‰¹æ€§**:
  - ä¸¤ç§è§¦å‘æ–¹å¼:
    - æ‰‹åŠ¨è§¦å‘: ç‚¹å‡»æŒ‰é’®æ‰§è¡Œ
    - å®šæ—¶è§¦å‘: æŒ‰é—´éš”è‡ªåŠ¨æ‰§è¡Œ
  - å››ç§åŠ¨ä½œç±»å‹:
    - log: æ—¥å¿—è®°å½•
    - alert: å¼¹çª—æç¤º
    - dispatch: æ´¾å‘äº‹ä»¶
    - api: è°ƒç”¨ API
  - å®æ—¶æ—¥å¿—è®°å½• (æ—¶é—´æˆ³ + æ¶ˆæ¯ + ç±»å‹)
  - æ—¥å¿—ç±»å‹ç€è‰² (info/success/warning/error)
  - å¯ç”¨/ç¦ç”¨å¼€å…³
  - æ¸…é™¤æ—¥å¿—åŠŸèƒ½
  - æš—è‰²ä¸»é¢˜ UI
- **é…ç½®é¡¹**:
  - enabled: å¯ç”¨çŠ¶æ€
  - triggerType: è§¦å‘ç±»å‹ (manual/interval)
  - interval: è§¦å‘é—´éš” (æ¯«ç§’)
  - action: åŠ¨ä½œç±»å‹
  - actionData: åŠ¨ä½œæ•°æ®
  - condition: è§¦å‘æ¡ä»¶ (é¢„ç•™)
  - showClearButton: æ˜¾ç¤ºæ¸…é™¤æŒ‰é’®
- **æ•°æ®æº**: æ”¯æŒä» API è·å–è§¦å‘æ¡ä»¶ (conditionField)
- **æ–‡ä»¶**: `src/customComponents/advanced/trigger/trigger.vue`

---

### ğŸ”§ é…ç½®æ›´æ–°

#### 6. ç»„ä»¶æ³¨å†Œ

- åœ¨ `registry.ts` ä¸­æ³¨å†Œä¸‰ä¸ªæ–°ç»„ä»¶:
  - scripting (è„šæœ¬æ‰§è¡Œå™¨)
  - state (çŠ¶æ€ç®¡ç†å™¨)
  - trigger (è§¦å‘å™¨)
- **æ–‡ä»¶**: `src/customComponents/registry.ts`

#### 7. Component Store é…ç½®

- **defaultStyleByType**: ä¸ºä¸‰ä¸ªé«˜çº§ç»„ä»¶æ·»åŠ é»˜è®¤æ ·å¼
  - æš—è‰²ä¸»é¢˜èƒŒæ™¯è‰²
  - ç­‰å®½å­—ä½“ (Consolas, Monaco)
  - ç»Ÿä¸€çš„å†…è¾¹è·ã€è¾¹æ¡†ã€åœ†è§’
- **defaultPropsByType**: æ·»åŠ é»˜è®¤å±æ€§é…ç½®
  - scripting: ç¤ºä¾‹ JavaScript ä»£ç 
  - state: ç¤ºä¾‹çŠ¶æ€ JSON
  - trigger: é»˜è®¤è§¦å‘å™¨é…ç½®
- **defaultDataSourceByType**: é…ç½®æ•°æ®æºå­—æ®µæ˜ å°„
  - scriptField, stateField, conditionField
- **æ–‡ä»¶**: `src/stores/component.ts`

#### 8. Mock API æ·»åŠ 

- **API #37**: `/api/scripting` - è„šæœ¬ä»£ç æ•°æ®
  - éšæœºè¿”å›ä¸‰ç§ç¤ºä¾‹è„šæœ¬:
    - æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—
    - éšæœºæ•°æ®ç»Ÿè®¡
    - æ—¥æœŸæ—¶é—´æ“ä½œ
- **API #38**: `/api/state` - çŠ¶æ€æ•°æ®
  - ç³»ç»Ÿä¿¡æ¯ (name, version, uptime, status)
  - ç”¨æˆ·ä¿¡æ¯ (id, name, role, permissions)
  - ç»Ÿè®¡æ•°æ® (totalUsers, activeUsers, errorRate)
  - é…ç½®ä¿¡æ¯ (theme, language, autoSave)
  - å®æ—¶æ•°æ® (timestamp, temperature, humidity, pressure)
- **API #39**: `/api/trigger` - è§¦å‘å™¨é…ç½®
  - éšæœºè¿”å›åŠ¨ä½œç±»å‹å’Œæ•°æ®
  - æ¡ä»¶è¡¨è¾¾å¼
  - å¯ç”¨çŠ¶æ€
- **æ–‡ä»¶**: `test/mockServer.mjs`

#### 9. Properties å±æ€§é¢æ¿é…ç½®

##### styleSchema (æ ·å¼é…ç½®)

ä¸ºä¸‰ä¸ªé«˜çº§ç»„ä»¶æ·»åŠ æ ·å¼å­—æ®µ:

- padding (å†…è¾¹è·)
- backgroundColor (èƒŒæ™¯é¢œè‰²)
- textColor (æ–‡å­—é¢œè‰²)
- fontSize (å­—ä½“å¤§å°)
- lineHeight (è¡Œé«˜)
- borderRadius (åœ†è§’)
- border (è¾¹æ¡†)
- fontFamily (å­—ä½“)

##### dataSourceSchema (æ•°æ®æºé…ç½®)

ä¸ºä¸‰ä¸ªé«˜çº§ç»„ä»¶é…ç½®æ•°æ®æº:

- enabled (å¯ç”¨å¼€å…³)
- url (API åœ°å€)
- method (è¯·æ±‚æ–¹æ³•)
- interval (è‡ªåŠ¨åˆ·æ–°)
- dataPath (æ•°æ®è·¯å¾„)
- å­—æ®µæ˜ å°„ (scriptField/stateField/conditionField)
- headers (è¯·æ±‚å¤´)

##### componentSchema (ç»„ä»¶å±æ€§é…ç½®)

- **scripting**:
  - script: JavaScript ä»£ç 
  - autoRun: è‡ªåŠ¨æ‰§è¡Œ
  - showCode: æ˜¾ç¤ºä»£ç 
  - showControls: æ˜¾ç¤ºæ§åˆ¶æŒ‰é’®
  - showPlaceholder: æ˜¾ç¤ºå ä½æç¤º
- **state**:
  - state: çŠ¶æ€æ•°æ® (JSON)
  - viewMode: è§†å›¾æ¨¡å¼ (list/json/table)
  - placeholder: å ä½æç¤º
- **trigger**:
  - enabled: å¯ç”¨è§¦å‘å™¨
  - triggerType: è§¦å‘ç±»å‹ (manual/interval)
  - interval: è§¦å‘é—´éš”
  - action: åŠ¨ä½œç±»å‹ (log/alert/dispatch/api)
  - actionData: åŠ¨ä½œæ•°æ®
  - condition: è§¦å‘æ¡ä»¶
  - showClearButton: æ˜¾ç¤ºæ¸…é™¤æŒ‰é’®

**æ–‡ä»¶**: `src/components/siderBar/properties/properties.ts`

---

### ğŸ“¦ ä¾èµ–æ›´æ–°

- å·²å®‰è£…ä¾èµ– (ä¸Šæ¬¡ commit):
  - marked (Markdown æ¸²æŸ“)
  - dompurify (XSS é˜²æŠ¤)
  - @types/dompurify (ç±»å‹å®šä¹‰)

---

### ğŸ“Š ç»„ä»¶ç»Ÿè®¡

#### æ–°å¢ç»„ä»¶

- scripting (è„šæœ¬æ‰§è¡Œå™¨) - é«˜çº§åŠŸèƒ½
- state (çŠ¶æ€ç®¡ç†å™¨) - é«˜çº§åŠŸèƒ½
- trigger (è§¦å‘å™¨) - é«˜çº§åŠŸèƒ½

#### æ€»ç»„ä»¶æ•°é‡

- KPI ç»„ä»¶: 6 ä¸ª
- å›¾è¡¨ç»„ä»¶: 10 ä¸ª
- æ•°æ®ç»„ä»¶: 5 ä¸ª
- æ§ä»¶ç»„ä»¶: 8 ä¸ª
- å¸ƒå±€ç»„ä»¶: 7 ä¸ª
- åª’ä½“ç»„ä»¶: 2 ä¸ª
- å†…å®¹ç»„ä»¶: 3 ä¸ª
- **é«˜çº§åŠŸèƒ½: 3 ä¸ª**
- **æ€»è®¡: 44 ä¸ªç»„ä»¶**

---

### ğŸ¯ æŠ€æœ¯äº®ç‚¹

1. **å®‰å…¨æ²™ç®±æ‰§è¡Œ**: ä½¿ç”¨ Function æ„é€ å‡½æ•°åˆ›å»ºéš”ç¦»ç¯å¢ƒ,é˜²æ­¢æ¶æ„ä»£ç 
2. **è‡ªå®šä¹‰ Console**: æ•è· console.log/error/warn è¾“å‡ºåˆ°ç»„ä»¶å†…
3. **å¤šè§†å›¾æ¨¡å¼**: State ç»„ä»¶æ”¯æŒ 3 ç§è§†å›¾åˆ‡æ¢,æ»¡è¶³ä¸åŒåœºæ™¯
4. **å®æ—¶æ—¥å¿—ç³»ç»Ÿ**: Trigger ç»„ä»¶å¸¦æ—¶é—´æˆ³å’Œç±»å‹ç€è‰²çš„æ—¥å¿—è®°å½•
5. **å®šæ—¶å™¨ç®¡ç†**: Trigger ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†,è‡ªåŠ¨æ¸…ç†å®šæ—¶å™¨
6. **ç±»å‹æ£€æµ‹**: State ç»„ä»¶è‡ªåŠ¨è¯†åˆ«æ•°æ®ç±»å‹å¹¶ç€è‰²æ˜¾ç¤º
7. **æš—è‰²ä¸»é¢˜**: ä¸‰ä¸ªé«˜çº§ç»„ä»¶ç»Ÿä¸€ä½¿ç”¨ VS Code é£æ ¼æš—è‰²ä¸»é¢˜
8. **é«˜åº¦å¯é…ç½®**: æ¯ä¸ªç»„ä»¶éƒ½æ”¯æŒæ ·å¼ã€å±æ€§ã€æ•°æ®æºä¸‰å±‚é…ç½®

---

### ğŸ”„ å·¥ä½œæµç¨‹

ç”¨æˆ·é€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ç”¨é«˜çº§ç»„ä»¶:

1. **ä»ç»„ä»¶é¢æ¿æ‹–æ‹½**: åœ¨"é«˜çº§åŠŸèƒ½"åˆ†ç±»ä¸‹é€‰æ‹©ç»„ä»¶
2. **æ”¾ç½®åˆ°ç”»å¸ƒ**: ç»„ä»¶è‡ªåŠ¨åº”ç”¨é»˜è®¤é…ç½®
3. **å±æ€§é¢æ¿é…ç½®**:
   - æ ·å¼: è°ƒæ•´é¢œè‰²ã€å­—ä½“ã€è¾¹è·ç­‰
   - æ•°æ®æº: è¿æ¥åç«¯ API
   - ç»„ä»¶å±æ€§: é…ç½®è¡Œä¸ºå’Œæ˜¾ç¤ºé€‰é¡¹
4. **å®æ—¶é¢„è§ˆ**: æ‰€æœ‰æ”¹åŠ¨ç«‹å³åæ˜ åœ¨ç”»å¸ƒä¸­
5. **æ•°æ®è”åŠ¨**: å¯é€šè¿‡æ•°æ®æºä¸å…¶ä»–ç»„ä»¶è”åŠ¨

---

### ğŸ“ å¾…ä¼˜åŒ–é¡¹

1. Trigger ç»„ä»¶çš„æ¡ä»¶åˆ¤æ–­åŠŸèƒ½ (å·²é¢„ç•™ condition å­—æ®µ)
2. Scripting ç»„ä»¶çš„ä»£ç ç¼–è¾‘å™¨ (å¯é›†æˆ Monaco Editor)
3. State ç»„ä»¶çš„æ•°æ®ç¼–è¾‘åŠŸèƒ½
4. é«˜çº§ç»„ä»¶ä¹‹é—´çš„è”åŠ¨ (å¦‚ Trigger è§¦å‘ Scripting æ‰§è¡Œ)
5. é”™è¯¯è¾¹ç•Œå¤„ç†å’Œæ—¥å¿—è®°å½•ç³»ç»Ÿ

---

### âœ… æœ¬æ¬¡å¼€å‘æ€»ç»“

æœ¬æ¬¡æ›´æ–°ä¸»è¦å®Œæˆäº†ä¸‰ä¸ªé«˜çº§åŠŸèƒ½ç»„ä»¶çš„å¼€å‘,ä¸ºå¹³å°å¢åŠ äº†è„šæœ¬æ‰§è¡Œã€çŠ¶æ€ç®¡ç†å’Œè§¦å‘å™¨åŠŸèƒ½ã€‚è¿™äº›ç»„ä»¶:

- âœ… æ”¯æŒå®Œæ•´çš„æ ·å¼è‡ªå®šä¹‰
- âœ… æ”¯æŒæ•°æ®æºé›†æˆ
- âœ… æä¾›ä¸°å¯Œçš„é…ç½®é€‰é¡¹
- âœ… ä½¿ç”¨æš—è‰²ä¸»é¢˜ç»Ÿä¸€è§†è§‰é£æ ¼
- âœ… å®Œæ•´çš„ Mock API æµ‹è¯•æ”¯æŒ
- âœ… è¯¦ç»†çš„å±æ€§é¢æ¿é…ç½®

åŒæ—¶ä¿®å¤äº† videoã€htmlã€iframe ç»„ä»¶çš„å·²çŸ¥é—®é¢˜,æå‡äº†ç»„ä»¶åº“çš„æ•´ä½“è´¨é‡å’Œå¯ç”¨æ€§ã€‚
